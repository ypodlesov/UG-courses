
# Язык Си. Написание программ и их выполнение. Терминал.

## Введение в язык Си

Язык Си разрабатывался в 1969-1973 года в лабораториях **Bell Labs**. В 1973 году б*о*льшая часть ядра Unix (операционная система) была переписана на Си. Авторы языка - Деннис Ритчи и Брайан Керниган, в 1978 году появилось первое издание книги **Язык программирования Си**. Более подробно про историю создания и различные легенды с ним связанные можно прочитать [здесь](https://habr.com/ru/post/114588/).

На настоящий момент (2022 год) существуют следующие стандарты:
1. ANSI C (C89)
2. C99
3. C11
4. C17

Каждый стандарт добавляет что-то новое, но ничего не убирает из языка Си (сделано для того, чтобы код, написанный в 80-х годах работал 2022 году так как и должен). 

Язык Си является компилируемым языком программирования. 

*Компилируемый* означает, что он преобразуется компилятором в машинный код и выполняется на компьютере операционной системой.

## Написание программ и их выполнение

Написание программы на языке Си можно условно разбить на три основных этапа: 

1. Написание исходного кода программы и помещение его в файл с расширением `.c`
2. Компилирование исходного кода, т. е. превращение его в исполняемый машинный код, который помещается в исполняемый файл
3. Выполнение исполняемого кода на компьютере. 

Все эти три этапа могут быть реализованы по разному. Здесь есть два основных пути:

- Первый путь - написание кода, его компиляция и выполнение в интегрированной среде разработки (IDE - Integrated Development Environment). Проще говоря Вы всё делаете внутри какого-то приложения. Пишите в нем сначала текст программы, потом запускаете вашу программу по кнопке. В данном случае условно нажатие на кнопку запуска программы на Си включает в себя её компиляцию и выполнение. Такой вариант больше подходит для больших проектов с множеством зависимостей между подпрограммами, проектов, над которыми работает команда разработчиков. В учебных же целях IDE как правило предлагают избыточный функционал и на деле используется крохотная его часть. Более того, существенный недостаток состоит в том, что такие приложения потребляют много ресурсов процессора и оперативной памяти. Среди наиболее популярных можно выделить: **CLion**, **CodeBlocks**, **Microsoft Visual Studio** и другие.  
- Второй путь - написание кода в текстовом редакторе, его компиляция и выполнение в терминале. Наиболее популярные текстовые редакторы: **Atom**, **Visual Studio Code** (не то же самое что **Visual Studio**) другие. Стоит также привести примеры так называемых терминальных редакторов: **Vim**, **Emacs**, **Nano**. Их основное преимущество является больший потенциал в скорости написания кода. Главный недостаток - сложность использования (короче, сложно, но если научитесь будете доминировать).

Использование интегрированных сред разработки не нуждается в подробном (да и наверное в принципе не нуждается) объяснении, в то время как использование терминала для компиляции и исполнения своих программ на Си (и не только) является необходимым для новчика в программировании. 

## Основные команды терминала Linux. 

У большинства людей на персональных компьютерах или ноутбуках установлена одна из следующих операционных систем: **Windows**, **MacOS** или **Linux**, последняя особенно распространена среди программистов. Поэтому все команды будут приведены для терминала на **Linux**, но они в 99% случаев так же будут работать на **MacOS** и в 98% случаев на **Windows**. 

> #### Для пользователей **Windows**
> Можно скачать приложение Terminal по этой [ссылке](https://apps.microsoft.com/store/detail/windows-terminal/9N0DX20HK701?hl=ru-ru&gl=ru), его можно сконфигурировать под терминал на **Linux** (см. Интернет). Также есть возможность установить себе на компьютер вторую операционную систему (**Linux**, например).

Любая команда терминала имеет следующий вид `команда [параметр1] [параметр2] ...`.

### Команда `man`

**Краткое описание** - выводит мануал по команде, которая передаётся в качетсве одного из аргументов. 

Например при вводе в терминал `man man` (всё до символа % включительно является приглашением терминала к вводу команд, это приглашение может выглядеть иначе на Вашем компьютере)
```console
yegorpodlesov@MyMac class_01 % man man
```

После нажатия **Enter** нас перекидывает на страницу мануала, где мы можем видеть то же содержание, что и по [ссылке](http://www.opennet.ru/man.shtml?category=1&russian=0&topic=man).

### Самостоятельно выясните что делают следующие команды терминала и какие у них есть параметры (все перечислять не нужно, только основные)

1. `cd` 
2. `ls`
3. `pwd`
4. `cat`
5. `vim` 
6. `nano`
7. `mkdir`
8. `touch`
9. `rm`
10. `rmdir`
11. `cc` 
12. `clear`

## Компиляция и выполнение программы из терминала

Формально мы не приступали к непосредственному изучению языка Си, поэтому ниже мы будем пользоваться максимально простыми примерами и по возможности пояснять код. 
Предположим что в текущая дериктория (как узнать её имя?) содержит файл `hello.c` где содержится исходный код нашей программы. 
**main.c**
```c
#include <stdio.h> // подключаем библиотеку stdio.h  

int main() // начинаем нашу функцию main
{
    printf("Hello! What is your name?\n"); // выводим на экран сообщение и ставим в конце перенос строки (\n)

    return 0; // завершаем функцию main
}
```

Чтобы посмотреть на результат выполнения нашей программы нам потребуется установленный компилятор. Для начала проверим, устоновлен ли он.
Сделать это можно так:
```console
yegorpodlesov@MyMac class_01 % gcc --version
```
или так:
```console
yegorpodlesov@MyMac class_01 % cc -v
```
Если вывод не похож на такой (пример приводится с **MacOS** на процессоре **Intel x86**)
```console
Apple clang version 14.0.0 (clang-1400.0.29.102)
Target: x86_64-apple-darwin21.6.0
Thread model: posix
InstalledDir: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin
```
или такой 
```console
gcc (Debian 8.3.0-6) 8.3.0
Copyright (C) 2018 Free Software Foundation, Inc.
This is free software; see the source for copying conditions.  There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. 
```
то требуется установка.
- Инструкцию по скачиванию компилятора `gcc` на **Windows** можно посмотреть [здесь](https://programforyou.ru/poleznoe/kak-ustanovit-gcc-dlya-windows). 
- Если Ваш компьютер под **Linux**, то вот [инструкция](https://baks.dev/article/debian/how-to-install-gcc-compiler-on-debian-10-linux).  
- **MacOS** - [сюда](https://russianblogs.com/article/64662030029/).

Теперь все готово и можно приступать (все команды пронумерованы). 
```console
(1)yegorpodlesov@MyMac class_01 % ls
README.md	hello.c
(2)yegorpodlesov@MyMac class_01 % gcc hello.c
(3)yegorpodlesov@MyMac class_01 % ls
README.md	a.out		hello.c
(4)yegorpodlesov@MyMac class_01 % ./a.out
Hello! What is your name?
```
1. видим в текущей директории наш файл с исходным кодом `hello.c` 
2. компилируем нашу программу без каких-либо опций (о них чуть позже)
3. видим в текущей директории появился еще один файл `a.out` - это и есть наш исполняемый файл. По умолчанию компилятор даёт исполняемым файлам имя `a.out`
4. выполняем нашу программу

Компилятор `gcc` может принимать большое множество опций. Наиболее необходимыми на данный момент являются опции: `-o` и `-std`. Перекомпилируем нашу программу с данными опциями:
```console
(1)yegorpodlesov@MyMac class_01 % ls                               
README.md	hello.c
(2)yegorpodlesov@MyMac class_01 % gcc -std=c17 hello.c -o main 
(3)yegorpodlesov@MyMac class_01 % ls
README.md	hello.c		main
(4)yegorpodlesov@MyMac class_01 % ./main
Hello! What is your name?
```
Как можно видеть результат тот же. Отличие состоит в том, что теперь мы явно указали имя `main`, которое должно быть присвоено исполняемому файлу на выходе `-o main`, а также явно указали стандарт языка c17 - `-std=c17` (пока что для нас безразлично какой стандарт `c99` или `c17`). 

## Перенаправление потока ввода/вывода

Расскажем ещё об одной полезной опции **выполнения** (не компиляции), а именно перенаправление ввода/вывода. Наша программа намекает на интерактив с пользоватем через консоль. Допишем программу и приведём её к такому виду:
```c
#include <stdio.h> // подключаем библиотеку stdio.h  

int main() // начинаем нашу функцию main
{
    printf("Hello! What is your name?\n"); // выводим на экран сообщение и ставим в конце перенос строки (\n)
    char name[50];
    scanf("%s", name); // считывание имени с консоли
    printf("Nice to meet you, %s!\n", name); // вывод еще одного сообщения на консоль (с переводом строки в конце)

    return 0; // завершаем функцию main
}
```
Скомпилируем и выполним программу.
```console
yegorpodlesov@MyMac class_01 % gcc hello1.c -o main
yegorpodlesov@MyMac class_01 % ./main
Hello! What is your name?
Yegor
Nice to meet you, Yegor!
```
Теперь снова: скомпилируем нашу программу
```console
yegorpodlesov@MyMac class_01 % gcc hello1.c -o main
```
А выполним со следующей опцией:
```console
yegorpodlesov@MyMac class_01 % ./main > out    
Yegor
```
Теперь посмотрим что лежит в нашем каталоге. Видим новый файл `out`
```console
yegorpodlesov@MyMac class_01 % ls
README.md	hello.c		hello1.c	main		out
```
Узнаем сдержимое файла `out`
```console
yegorpodlesov@MyMac class_01 % cat out
Hello! What is your name?
Nice to meet you, Yegor!
```
Мы видим, что в нём находится всё то, что было выведено при обычном выполнении на консоль. Таким образом, мы только что пернаправили стандартный поток вывода с консоли в файл `out`

> Если такого файла не существовало, то он автоматически создастся и в него будет записан результат. Если же он существовал, то все его содержимое будет стёрто и запишется новый результат. Если требуется добавить новую информацию в файл, не стирая его содержимое, то используются двойные стрелочки (>>)

Аналогично можно поступать со стандартным потоком ввода, при условии, что файл существует, иначе получим ошибку. 
```console
(1)yegorpodlesov@MyMac class_01 % ls
README.md	hello.c		hello1.c	main		out
(2)yegorpodlesov@MyMac class_01 % cat - > in
Yegor
(3)yegorpodlesov@MyMac class_01 % ls  
README.md	hello1.c	main
hello.c		in		out
(4)yegorpodlesov@MyMac class_01 % cat in
Yegor
(5)yegorpodlesov@MyMac class_01 % gcc hello1.c -o main
(6)yegorpodlesov@MyMac class_01 % ./main <in >out
(7)yegorpodlesov@MyMac class_01 % cat out
Hello! What is your name?
Nice to meet you, Yegor!
```
Как можем видеть результат тот же. Обратите внимание, что в команде (2) мы также использовали перенаправление стандартного потока вывода. После записи нашего имени необходимо нажать `Ctrl-D`, чтобы завершить ввод. 

## Этапы компилации программы
1. Препроцессирование - подключение всех заголовочных файлов
2. Трансляция исходного кода программы на Си в код на языке ассемблер в соответствующей архитектуре.
3. Трансляция ассемблерного кода в объектный код.
4. Компоновка - связывание всех объектных файлов воедино.




































